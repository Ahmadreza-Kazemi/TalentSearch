<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>استعدادیاب | فهرست تعالی فردی - 37</title>
    <meta name="description" content="آزمون فهرست تعالی فردی - 37 برای ارزیابی ویژگی‌های رشد و تعالی فردی شما.">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/assessment-form.css">
</head>
<body>
    <div class="header"></div>
    <main class="main-content">
        <section id="assessment-form" class="assessment-form">
            <iframe
                id="assessmentIframe"
                src="" <!-- Initially empty; will be set by JavaScript -->
                scrolling="yes"
                name="myiFrame"
                frameborder="1"
                marginheight="0"
                marginwidth="0"
                style="width: 100%; height: calc(100vh + 10px); border: none;"
                title="فرم ارزیابی"
            ></iframe>
        </section>
    </main>
    <div class="footer"></div>
    <script src="/assets/js/script.js"></script>
    <script src="/assets/js/header-footer-inject.js"></script>
    
    <!-- New Script to Dynamically Set iframe src Based on URL Parameters -->
    <script>
        (function() {
            // Mapping of 'test' parameter values to Form IDs
            const testToFormIdMap = {
                "Job-Satisfaction": "jyzyq",
                "Marriage-Satisfaction": "h6a3s",
                "Individual-Satisfaction": "i5hv6",
                "Marriage-Readiness": "4zowk",
                "Adolescent": "cwllb",
                "General": "191pa",
                "Talent": "ifhf5",
                "Child": "vaxur",
                "mental-tranquility": "sh68g",
                "esteem": "vljt1",
                "child-talent-48": "npwsz",
                "child-talent-72": "csclb",
                "persistence": "40svj",
                "adolescent-mental-hygiene": "nh7oc",
                "purification": "i09gx",
                "stability": "rfayj",
                "empirical-analytical": "5sluk",
                "balance": "pi6c6",
                "mental-balance": "eg75q",
                "personal-excellence": "6rvrr",
                "personality-interaction": "elgp3",
                "personal-commitment": "rdfzb",
                "personal-space": "knuln",
                "spiritual-support": "ieewp",
                "wisdom": "wi5pw",
                "self-expansion": "9ytw7",
                "accuracy": "9xmbs",
                "life-satisfaction": "gz2qd",
                "marital-satisfaction": "j5g8u",
                "job-satisfaction": "8aj1t",
                "life-summit": "88p7y",
                "personality": "swa0t",
                "childrens-personality": "n60rv",
                "cognitive-24": "jwlit",
                "empirical-capacity": "owvqj",
                "cognitive-capacities": "tayf7",
                "corona": "cnjhr",
                "needs": "94buv",
                "duty": "ncaeh",
                "goal-oriented": "jql20",
                "successful-intelligence": "vock1",
                "thought-emotion": "pb1bu",
                "cognitive-integration": "fniq4",
                "life-satisfaction-25": "s88q3",
                "talent-interaction": "0ekrq"
            };

            /**
             * Function to get query parameters from the current URL.
             * @param {string} param - The name of the parameter to retrieve.
             * @returns {string|null} - The value of the parameter or null if not found.
             */
            function getQueryParam(param) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(param);
            }

            /**
             * Function to get the current 'test' and 'list' parameters.
             * @returns {Object} - An object containing 'test' and 'list' values.
             */
            function getParameters() {
                const test = getQueryParam('test');
                const list = getQueryParam('list');
                return { test, list };
            }

            /**
             * Function to construct the iframe src URL.
             * @param {string} formId - The Form ID to include in the URL.
             * @param {string|null} listParam - The list parameter value, if any.
             * @returns {string} - The constructed iframe src URL.
             */
            function constructIframeSrc(formId, listParam) {
                let src = `https://formafzar.com/form/${formId}`;
                if (listParam && listParam.trim() !== "") {
                    src += `?list=${encodeURIComponent(listParam)}`;
                }
                return src;
            }

            /**
             * Main function to set the iframe src.
             */
            function setIframeSrc() {
                const { test, list } = getParameters();

                if (!test) {
                    console.error("The 'test' parameter is missing in the URL.");
                    // Optionally, you can set a default iframe src or display a message to the user.
                    return;
                }

                const formId = testToFormIdMap[test];

                if (!formId) {
                    console.error(`No Form ID mapping found for test: ${test}`);
                    // Optionally, set a default Form ID or display an error message to the user.
                    return;
                }

                const iframeSrc = constructIframeSrc(formId, list);

                const iframe = document.getElementById('assessmentIframe');
                if (iframe) {
                    iframe.src = iframeSrc;
                } else {
                    console.error("Iframe with ID 'assessmentIframe' not found.");
                }
            }

            // Execute the main function after the DOM is fully loaded
            document.addEventListener("DOMContentLoaded", setIframeSrc);
        })();
    </script>
</body>
</html>
